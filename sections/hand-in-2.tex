\section{TGRA Handin 2}

\subsection{(10\%) Transformations and matrices}
You have access to  the same matrix and graphics classes as we built together this semester, that is a BoxGraphic class with a drawSolidCube that sends vertices into the pipeline for a cube of the size 1x1x1, centered in (0,0,0), and a ModelMatrix class with the basic transformation operations, matrix stack operations and shader manipulation operations. These classes have been created and initialized elsewhere.  You don’t need to remember the exact names of functions, just the idea behind each one you need to call, and what parameters they take. 

What you want to draw is the following scene: 

a) A box of size 2x2x2, centered in (9,5,-2) and under it a big flat floor which is 10x10 in the x-z plane but only 0.8 thick.  Its corner should be in (0,0,0) and its top edge level with the base x-z plane.

\subsubsection{(5\%) Write the code that would draw the scene described.  Imagine you’re already inside the display function and lights, colors and cameras have already been set.}

I assume that the BoxGraphic instances have been setup with the following scale and position class members: I ignore the rotation because it wasn't mentioned :)

$ Scale_{Box} = \left(\begin{array}{c}2.0\\2.0\\2.0\end{array}\right)$
$ Position_{Box} = \left(\begin{array}{c}9.0\\5.0\\-2.0\end{array}\right)$

$ Scale_{Plane} = \left(\begin{array}{c}10.0\\0.8\\10.0\end{array}\right)$
$ Position_{Plane} = \left(\begin{array}{c}5.0\\-0.4\\5.0\end{array}\right)$

I've created two solutions for the code. The first one is just the code I created without looking at my code or any material. The seconds solution is a revamped and detailed solution. I would like to get feedback for both if possible.

\textbf{First solution:}
\begin{verbatim}
    vertex_count = 6 * 2 * 3
    for e in entities:
        matrix = (ModelMatrix.identity()
            .translate(e.position)
            .scale(e.scale))
        gl.glLoadUniform(self.transformation_matrix_loc, matrix.c_ptr())
        e.drawSolidCube()
    
\end{verbatim}

\textbf{Second solution:}
\begin{verbatim}
    for e in entities:
        self.model_matrix.load_identity()
        self.model_matrix.translate(e.get_position())
        self.model_matrix.scale(e.get_scale())

        self.shader.set_model_matrix(self.model_matrix.matrix)
        e.drawSolidCube()

        pygame.display.flip()

\end{verbatim}

\subsubsection{b)  (5\%) Show the values that are in the shader’s model matrix when the first box is drawn.}

$ model\_matrix = \left(\begin{array}{cccc}2&0&0&9\\0&2&0&5\\0&0&2&-2\\0&0&0&1\end{array}\right) $

\textbf{Check with python for validation:}
\begin{verbatim}
    >>> import glm
    >>> mat = glm.mat4()
    >>> mat = glm.translate(mat, e.position)
    >>> mat = glm.scale(mat, e.scale)
    >>> print(mat)
    
    [            2 |            0 |            0 |            0 ]
    [            0 |            2 |            0 |            0 ]
    [            0 |            0 |            2 |            0 ]
    [            9 |            5 |           -2 |            1 ]
\end{verbatim}
\rule{\textwidth}{0.2mm}

\textbf{LaTeX is so much fun :)}

\newpage

\subsection{5.  Camera Transformations (30\%)} 
\subsubsection{a)  (15\%) A camera is set up to be positioned in (0,8,4) looking at the point (0,3,-1). It has an up vector (0,0,-1). Find the point of origin and vectors for the camera's coordinate frame.}

$
    origin
=
    \left(\begin{array}{c}
        8\\
        4
        0\\
    \end{array}\right)
$

I'm not a 100\% sure which vectors I should calculate for the coordinate frame but I expect that these are $ \vec{v}, \vec{n}, \vec{u} $ for the view matrix. This would also kind of make sense. So here we go:

$ 
    \vec{n}
=
    normalize(\vec{origin} - \vec{looking\_at})
=
    normalize\left(\begin{array}{c}
        0 - 0 \\
        8 - 3 \\
        4 - -1
    \end{array}\right) 
= 
    normalize\left(\begin{array}{c}
        0 \\
        5 \\
        5
    \end{array}\right)
\approx
    \left(\begin{array}{c}
        0\\
        0.707\\
        0.707
    \end{array}\right)
$

$
    \vec{u}
=
    normalize\left( \vec{up} \times \vec{n} \right)
\approx
    normalize\left(\begin{array}{c}
        0.707\\
        0\\
        0
    \end{array}\right)
=
    \left(\begin{array}{c}
        1\\
        0\\
        0
    \end{array}\right)
$

$
    \vec{v}
=
    normalize\left(\left(\vec{n} \times \vec{u} \right)\right)
\approx
    \left(\begin{array}{c}
        0\\
        0.707\\
        -0.707
    \end{array}\right)
$

\subsubsection{(5\%) Set up the values in a matrix that represents this position and orientation of a camera.\\Which matrix in your shader should be set to these values? }

% **Some old C++ code for this**
% 
%     Vec3 zAxis = Normalize(position - lookAt);
%     Vec3 xAxis = Normalize(Cross(up, zAxis));
%     Vec3 yAxis = Cross(zAxis, xAxis);
% 
%     *result =  Mat4(
%         Vec4(xAxis.X, yAxis.X, zAxis.X, 0.0f),
%         Vec4(xAxis.Y, yAxis.Y, zAxis.Y, 0.0f),
%         Vec4(xAxis.Z, yAxis.Z, zAxis.Z, 0.0f),
%         Vec4(-Dot(xAxis, position), -Dot(yAxis, position), -Dot(zAxis, position), 1.0f)
%     );
    
From formula sheet: $\left(
    \begin{array}{cccc}
        u_x & u_y & u_z & -(eye \circ u) \\
        v_x & v_y & v_z & -(eye \circ v) \\
        n_x & n_y & n_z & -(eye \circ n) \\
        0 & 0 & 0 & 1
    \end{array}
    \right)$



\texttt{ViewMatrix}
$
\approx
    \left(\begin{array}{cccc}
        1 & 0 & 0 & 0\\
        0 & 0.707 & -0.707 & -2.828\\
        0 & 0.707 & 0.707 & -8.485\\
        0 & 0 & 0 & 1
    \end{array}\right)
$

The view matrix should be set to these values.

\subsubsection{(10\%) The camera should have a field of view of 75 grad, an aspect ratio of 16:9, a near plane at 3 and a far plane at 25.  Find the exact values for a matrix that calculates this camera.\\ Which matrix in your shader should be set to these values? }

From formula sheet: $
    \left(\begin{array}{cccc}
        \frac{2N}{right-left} & 0 & \frac{right + left}{right - left} & 0 \\
        0 & \frac{2N}{top - bottom} & \frac{top + bottom}{top - bottom} & 0 \\
        0 & 0 & \frac{-(F + N)}{F - N} & \frac{-2 * F * N}{F - N} \\
        0 & 0 & -1 & 0
    \end{array}\right)
$

N = 3

F = 25

fov = 75

aspect = $\frac{16}{9}$

top = $ N * tan\left(\frac{fov}{2}\right) \approx 3 * 0.767 \approx 2.301 $

bottom = $ -top \approx -2.301$

right = $top * aspect \approx 4.091$

left = $-right \approx -4.091$

\texttt{ProjectionMatrix}
$
\approx
    \left(\begin{array}{cccc}
        0.733 & 0 & 0 & 0 \\
        0 & 1.304 & 0 & 0 \\
        0 & 0 & -1.273 & 6.812 \\
        0 & 0 & -1 & 0
    \end{array}\right)
$

The projection matrix should be set to these values.
